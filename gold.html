<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="js/vendor/jquery-1.11.3.min.js"></script>
    <script src="js/canvasjs.min.js"></script>
    <script src="js/papaparse.js"></script>
</head>
<body>
<div id="chartContainer" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>
<script type="text/javascript">

    var drawData = [];

    Papa.parse('http://proape.cn/gold.csv', {
        download: true,
        complete: function(results) {
            var len = results.data.length;
            if (len == 0) {
                return false;
            }
            var count = 0;
            var bull = 0;
            for (var i = 0; i < len; i++) {
                results.data[i] = results.data[i].filter(Boolean);
                if (results.data[i].length == 0) {
                    continue;
                }
                count += 1;
                if (results.data[i][1] == 1) {
                    bull += 1;
                }
                drawData.push({x: count, y: parseFloat((bull/count * 100).toFixed(2))});
            }
            console.log(drawData);
            chart.render();
        }
    });

    var chart = new CanvasJS.Chart("chartContainer", {
        animationEnabled: true,  
        title:{
            text: "Gold trade"
        },
        axisY: {
            title: "Bull Rate",
            /*stripLines: [{
                value: 3366500,
                label: "Average"
            }]*/
        },
        data: [{
            type: "spline",
            dataPoints: drawData
        }]
    });
</script>
</body>
</html>